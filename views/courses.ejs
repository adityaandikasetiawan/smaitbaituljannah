<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Program - Baituljannah</title>
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="/css/vendors.css">
  <link rel="stylesheet" href="/css/main.css">
</head>
<body class="preloader-visible" data-barba="wrapper">
  <!-- Preloader -->
  <div class="preloader js-preloader">
    <div class="preloader__wrap">
      <div class="preloader__icon">
        <div class="preloader__img"></div>
      </div>
    </div>
  </div>

  <main class="main-content">
    <%- include('partials/header') %>

    <!-- Page Header -->
    <section class="page-header -type-1">
      <div class="container">
        <div class="page-header__content">
          <div class="row justify-center text-center">
            <div class="col-auto">
              <div data-anim="slide-up delay-1">
                <h1 class="page-header__title">Courses</h1>
              </div>
              <div data-anim="slide-up delay-2">
                <p class="page-header__text">We're on a mission to deliver engaging, curated courses at a reasonable price.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Courses List -->
    <section class="layout-pt-120 layout-pb-120">
      <div data-anim-wrap class="container">
        <div class="row y-gap-60">
          <!-- Sidebar -->
          <div data-anim-child="slide-up delay-1" class="col-xl-3 col-lg-4 pr-30 lg:pr-0">
            <div class="sidebar -courses">
              <!-- Search Form -->
              <div class="sidebar__item">
                <h5 class="sidebar__title">Search Courses</h5>
                <form method="GET" action="/courses">
                  <input type="hidden" name="category" value="<%= selectedCategory %>">
                  <input type="hidden" name="sort" value="<%= selectedSort %>">
                  <div class="single-field -w-full">
                    <input class="form-control" type="text" name="search" placeholder="Search courses..." value="<%= searchQuery %>">
                    <button type="submit" class="absolute-center-right button text-24 -dark-1">
                      <i class="icon-search"></i>
                    </button>
                  </div>
                </form>
              </div>

              <!-- Categories -->
              <div class="sidebar__item">
                <div class="accordion js-accordion">
                  <div class="accordion__item js-accordion-item-active">
                    <div class="accordion__button items-center">
                      <h5 class="sidebar__title">Category</h5>
                      <div class="accordion__icon">
                        <div class="icon icon-chevron-down"></div>
                        <div class="icon icon-chevron-up"></div>
                      </div>
                    </div>
                    <div class="accordion__content">
                      <div class="accordion__content__inner">
                        <div class="sidebar-checkbox">
                          <div class="sidebar-checkbox__item">
                            <div class="form-radio">
                              <input type="radio" name="category" value="all" <%= selectedCategory === 'all' ? 'checked' : '' %> onchange="filterCourses()">
                              <div class="form-radio__mark">
                                <div class="form-radio__icon"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title">All Categories</div>
                          </div>
                          <% categories.forEach(category => { %>
                          <div class="sidebar-checkbox__item">
                            <div class="form-radio">
                              <input type="radio" name="category" value="<%= category.name.toLowerCase() %>" <%= selectedCategory === category.name.toLowerCase() ? 'checked' : '' %> onchange="filterCourses()">
                              <div class="form-radio__mark">
                                <div class="form-radio__icon"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title"><%= category.name %></div>
                            <div class="sidebar-checkbox__count">(<%= category.count %>)</div>
                          </div>
                          <% }) %>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Price Range -->
              <div class="sidebar__item">
                <div class="accordion js-accordion">
                  <div class="accordion__item js-accordion-item-active">
                    <div class="accordion__button items-center">
                      <h5 class="sidebar__title">Price</h5>
                      <div class="accordion__icon">
                        <div class="icon icon-chevron-down"></div>
                        <div class="icon icon-chevron-up"></div>
                      </div>
                    </div>
                    <div class="accordion__content">
                      <div class="accordion__content__inner">
                        <div class="sidebar-checkbox">
                          <div class="sidebar-checkbox__item">
                            <div class="form-checkbox">
                              <input type="checkbox" name="price" value="free">
                              <div class="form-checkbox__mark">
                                <div class="form-checkbox__icon icon-check"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title">Free</div>
                            <div class="sidebar-checkbox__count">(12)</div>
                          </div>
                          <div class="sidebar-checkbox__item">
                            <div class="form-checkbox">
                              <input type="checkbox" name="price" value="paid">
                              <div class="form-checkbox__mark">
                                <div class="form-checkbox__icon icon-check"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title">Paid</div>
                            <div class="sidebar-checkbox__count">(89)</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Level -->
              <div class="sidebar__item">
                <div class="accordion js-accordion">
                  <div class="accordion__item js-accordion-item-active">
                    <div class="accordion__button items-center">
                      <h5 class="sidebar__title">Level</h5>
                      <div class="accordion__icon">
                        <div class="icon icon-chevron-down"></div>
                        <div class="icon icon-chevron-up"></div>
                      </div>
                    </div>
                    <div class="accordion__content">
                      <div class="accordion__content__inner">
                        <div class="sidebar-checkbox">
                          <div class="sidebar-checkbox__item">
                            <div class="form-checkbox">
                              <input type="checkbox" name="level" value="beginner">
                              <div class="form-checkbox__mark">
                                <div class="form-checkbox__icon icon-check"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title">Beginner</div>
                            <div class="sidebar-checkbox__count">(45)</div>
                          </div>
                          <div class="sidebar-checkbox__item">
                            <div class="form-checkbox">
                              <input type="checkbox" name="level" value="intermediate">
                              <div class="form-checkbox__mark">
                                <div class="form-checkbox__icon icon-check"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title">Intermediate</div>
                            <div class="sidebar-checkbox__count">(32)</div>
                          </div>
                          <div class="sidebar-checkbox__item">
                            <div class="form-checkbox">
                              <input type="checkbox" name="level" value="expert">
                              <div class="form-checkbox__mark">
                                <div class="form-checkbox__icon icon-check"></div>
                              </div>
                            </div>
                            <div class="sidebar-checkbox__title">Expert</div>
                            <div class="sidebar-checkbox__count">(24)</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Main Content -->
          <div data-anim-child="slide-up delay-3" class="col-xl-9 col-lg-8">
            <!-- Results Header -->
            <div class="row y-gap-20 items-center justify-between pb-30">
              <div class="col-auto">
                <div class="text-14 lh-12">Showing <span class="text-dark-1 fw-500"><%= allCoursesData.length %></span> results
                  <% if (searchQuery) { %> for "<%= searchQuery %>"<% } %>
                  <% if (selectedCategory !== 'all') { %> in <%= selectedCategory %><% } %>
                </div>
              </div>
              <div class="col-auto">
                <div class="row x-gap-20 y-gap-20">
                  <div class="col-auto">
                    <div class="d-flex items-center">
                      <div class="text-14 lh-12 fw-500 text-dark-1 mr-20">Sort by:</div>
                      <form method="GET" action="/courses" style="display: inline;">
                        <input type="hidden" name="search" value="<%= searchQuery %>">
                        <input type="hidden" name="category" value="<%= selectedCategory %>">
                        <select name="sort" onchange="this.form.submit()" class="form-select text-14 rounded-8 px-20 py-10">
                          <option value="default" <%= selectedSort === 'default' ? 'selected' : '' %>>Default</option>
                          <option value="popular" <%= selectedSort === 'popular' ? 'selected' : '' %>>Most Popular</option>
                          <option value="rating" <%= selectedSort === 'rating' ? 'selected' : '' %>>Highest Rated</option>
                          <option value="newest" <%= selectedSort === 'newest' ? 'selected' : '' %>>Newest</option>
                          <option value="price-low" <%= selectedSort === 'price-low' ? 'selected' : '' %>>Price: Low to High</option>
                          <option value="price-high" <%= selectedSort === 'price-high' ? 'selected' : '' %>>Price: High to Low</option>
                        </select>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Courses Grid -->
            <div class="row y-gap-30">
              <% allCoursesData.forEach(course => { %>
              <div class="col-xl-4 col-lg-6 col-md-6">
                <a href="/courses/<%= course.id %>" class="coursesCard -type-1">
                  <div class="relative">
                    <div class="coursesCard__image overflow-hidden rounded-8">
                      <img class="w-1/1" src="<%= course.image %>" alt="<%= course.title %>">
                      <div class="coursesCard__image_overlay rounded-8"></div>
                    </div>
                    <div class="d-flex justify-between py-10 px-10 absolute-full-center z-3">
                      <% if (course.badges && course.badges.length > 0) { %>
                        <% course.badges.forEach(badge => { %>
                        <div>
                          <div class="px-15 rounded-200 bg-<%= badge.color %>">
                            <span class="text-11 lh-1 uppercase fw-500 text-<%= badge.textColor %>"><%= badge.text %></span>
                          </div>
                        </div>
                        <% }) %>
                      <% } %>
                    </div>
                  </div>

                  <div class="h-100 pt-15">
                    <!-- Rating -->
                    <div class="d-flex items-center">
                      <div class="text-14 lh-1 text-yellow-1 mr-10"><%= course.rating %></div>
                      <div class="d-flex x-gap-5 items-center">
                        <% for (let i = 1; i <= 5; i++) { %>
                          <div class="icon-star text-9 <%= i <= Math.floor(course.rating) ? 'text-yellow-1' : 'text-light-1' %>"></div>
                        <% } %>
                      </div>
                      <div class="text-13 lh-1 ml-10">(<%= course.reviews %>)</div>
                    </div>

                    <!-- Title -->
                    <div class="text-17 lh-15 fw-500 text-dark-1 mt-10"><%= course.title %></div>

                    <!-- Course Info -->
                    <div class="d-flex x-gap-10 items-center pt-10">
                      <div class="d-flex items-center">
                        <div class="mr-8">
                          <img src="/img/coursesCards/icons/1.svg" alt="lessons">
                        </div>
                        <div class="text-14 lh-1"><%= course.lessons %> lesson<%= course.lessons > 1 ? 's' : '' %></div>
                      </div>
                      <div class="d-flex items-center">
                        <div class="mr-8">
                          <img src="/img/coursesCards/icons/2.svg" alt="duration">
                        </div>
                        <div class="text-14 lh-1"><%= course.duration %></div>
                      </div>
                      <div class="d-flex items-center">
                        <div class="mr-8">
                          <img src="/img/coursesCards/icons/3.svg" alt="level">
                        </div>
                        <div class="text-14 lh-1"><%= course.level %></div>
                      </div>
                    </div>

                    <!-- Footer -->
                    <div class="coursesCard-footer">
                      <div class="coursesCard-footer__author">
                        <img src="/img/avatars/small-1.png" alt="<%= course.instructor %>">
                        <div><%= course.instructor %></div>
                      </div>
                      <div class="coursesCard-footer__price">
                        <% if (course.originalPrice && course.originalPrice !== course.price) { %>
                          <div>$<%= course.originalPrice %></div>
                        <% } %>
                        <div>$<%= course.price %></div>
                      </div>
                    </div>
                  </div>
                </a>
              </div>
              <% }) %>
            </div>

            <!-- Pagination -->
            <div class="row justify-center pt-90 lg:pt-50">
              <div class="col-auto">
                <div class="pagination -buttons">
                  <button class="pagination__button -prev">
                    <i class="icon icon-chevron-left"></i>
                  </button>
                  <div class="pagination__count">
                    <a href="#">1</a>
                    <a href="#" class="-count-is-active">2</a>
                    <a href="#">3</a>
                    <span>...</span>
                    <a href="#">67</a>
                  </div>
                  <button class="pagination__button -next">
                    <i class="icon icon-chevron-right"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <%- include('partials/footer') %>
  </main>

  <!-- JavaScript -->
  <script src="/js/vendors.js"></script>
  <script src="/js/main.js"></script>
  <script>
    function filterCourses() {
      const form = document.createElement('form');
      form.method = 'GET';
      form.action = '/courses';
      
      // Get search query
      const searchInput = document.querySelector('input[name="search"]');
      if (searchInput && searchInput.value) {
        const searchField = document.createElement('input');
        searchField.type = 'hidden';
        searchField.name = 'search';
        searchField.value = searchInput.value;
        form.appendChild(searchField);
      }
      
      // Get selected category
      const selectedCategory = document.querySelector('input[name="category"]:checked');
      if (selectedCategory) {
        const categoryField = document.createElement('input');
        categoryField.type = 'hidden';
        categoryField.name = 'category';
        categoryField.value = selectedCategory.value;
        form.appendChild(categoryField);
      }
      
      // Get current sort
      const sortSelect = document.querySelector('select[name="sort"]');
      if (sortSelect) {
        const sortField = document.createElement('input');
        sortField.type = 'hidden';
        sortField.name = 'sort';
        sortField.value = sortSelect.value;
        form.appendChild(sortField);
      }
      
      document.body.appendChild(form);
      form.submit();
    }
  </script>
</body>
</html>